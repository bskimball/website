---
import BaseHead from '@/components/BaseHead.astro'
import Header from '@/components/Header.astro'
import Footer from '@/components/Footer.astro'
import { SITE_TITLE, SITE_DESCRIPTION } from '@/consts'
import { getCollection } from 'astro:content'
import BentoCard from '@/components/BentoCard.astro'
import SectionDivider from '@/components/SectionDivider.astro'

const posts = (await getCollection('blog'))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 9) // Limit to 9 posts for the home page grid
---

<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <body
    class="bg-background text-foreground antialiased selection:bg-primary selection:text-background"
  >
    <div class="noise-overlay"></div>
    <Header />
    <main>
      <section
        class="min-h-screen flex flex-col justify-center relative overflow-hidden"
      >
        <div
          class="container relative flex flex-col justify-center min-h-screen"
        >
          <!-- Center Headline -->
          <div class="relative z-10">
            <h1
              class="font-serif text-[15vw] lg:text-[13rem] leading-[0.85] tracking-tighter mix-blend-difference"
            >
              Brian<br />
              <span class="text-primary">Kimball</span>
            </h1>
          </div>

          <!-- Bottom Right CTA & Spec -->
          <!-- <div class="absolute bottom-12 right-8 flex flex-col items-end gap-8">
            <div class="font-mono text-xs tracking-[0.2em] text-primary/70 text-right leading-relaxed">
              Portfolio 2026 // <br/>
              Personal Archive
            </div>
            <a 
              href="/blog" 
              class="group relative px-10 py-5 border border-primary text-primary font-mono text-sm tracking-[0.3em] hover:bg-primary hover:text-background transition-all duration-300 no-underline"
            >
              Enter Archive
            </a>
          </div> -->
        </div>
      </section>

      <SectionDivider />

      <!-- Bento Grid -->
      <section class="py-24">
        <div class="container">
          <div
            class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-12 gap-4 auto-rows-[minmax(240px,auto)]"
          >
            {
              posts.map((post, index) => {
                let colSpan = 'lg:col-span-3'
                let rowSpan = ''

                if (index === 0) {
                  colSpan = 'md:col-span-2 lg:col-span-6'
                  rowSpan = 'row-span-2'
                } else if (index === 1 || index === 2) {
                  colSpan = 'md:col-span-1 lg:col-span-3'
                }

                return (
                  <BentoCard
                    post={post}
                    class={`${colSpan} ${rowSpan}`}
                    featured={index === 0}
                  />
                )
              })
            }
          </div>
        </div>
      </section>
    </main>
    <Footer />
  </body>
</html>

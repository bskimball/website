---
import BaseHead from '@/components/BaseHead.astro'
import Header from '@/components/Header.astro'
import Footer from '@/components/Footer.astro'
import { SITE_TITLE, SITE_DESCRIPTION } from '@/consts'
import { getCollection } from 'astro:content'
import BentoCard from '@/components/BentoCard.astro'
import SectionDivider from '@/components/SectionDivider.astro'

const posts = (await getCollection('blog'))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 9) // Limit to 9 posts for the home page grid
---

<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <body
    class="bg-background text-foreground antialiased selection:bg-primary selection:text-background"
  >
    <div class="noise-overlay"></div>
    <Header />
    <main>
      <section
        class="min-h-screen flex flex-col justify-center relative overflow-hidden"
      >
        <div
          class="container relative flex flex-col justify-center min-h-screen"
        >
          <div
            class="absolute top-12 left-8 md:top-24 font-mono text-xs tracking-widest text-foreground/40 select-none"
          >
            FIG 1.0 // IDENTITY
          </div>

          <!-- Center Headline -->
          <div class="relative z-10">
            <h1
              class="font-serif text-[15vw] lg:text-[13rem] leading-[0.85] tracking-tighter mix-blend-difference"
            >
              Brian<br />
              <span class="text-primary">Kimball</span>
            </h1>
            <div
              class="mt-12 font-mono text-sm md:text-base tracking-widest text-foreground/60 max-w-lg"
            >
              SYSTEMS ENGINEER / DEVELOPER
              <span class="block text-primary mt-2"
                >BUILDING FROM THE METAL UP</span
              >
            </div>
          </div>
        </div>
      </section>

      <SectionDivider />

      <!-- Bento Grid -->
      <section class="py-20">
        <div class="container">
          <div
            class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-12 gap-4 auto-rows-[minmax(240px,auto)]"
          >
            {
              posts.map((post, index) => {
                let colSpan = 'lg:col-span-3'
                let rowSpan = ''

                if (index === 0) {
                  colSpan = 'md:col-span-2 lg:col-span-6'
                  rowSpan = 'row-span-2'
                } else if (index === 1 || index === 2) {
                  colSpan = 'md:col-span-1 lg:col-span-3'
                }

                return (
                  <BentoCard
                    post={post}
                    class={`${colSpan} ${rowSpan}`}
                    featured={index === 0}
                  />
                )
              })
            }
          </div>
        </div>
      </section>
    </main>
    <Footer />
  </body>
</html>
